<main id="wow-world">
<div class="wrap">
<nav aria-label="Breadcrumb" class="breadcrumb"><span style="font-size:clamp(26px,4.4vw,40px);font-weight:900;letter-spacing:.2px;color:#1f2937">世界之窗</span></nav>

<header aria-labelledby="world-title" class="world-hero">
<p class="sub">一頁看懂小人國微縮世界的五大展區&mdash;&mdash;從臺灣到美洲，大小朋友邊玩邊學歷史地理！</p>

<div class="notice" role="note"><strong>溫馨提醒：</strong>請<strong>勿進入微縮景觀限制區域</strong>或<strong>觸碰模型</strong>，為孩子示範公德心。了解更多： <a href="https://wow.com.tw/tw/news/show.aspx?num=3383&amp;kind=10" rel="noopener" target="_blank">請發揮公德心，勿進入微縮景觀限制區域</a>。</div>

<nav aria-label="頁內索引" class="index-nav"><a href="#tw">迷你臺灣</a> <a href="#cn">迷你中國</a> <a href="#asia">迷你亞洲</a> <a href="#eu">迷你歐洲</a> <a href="#us">迷你美洲</a></nav>
</header>
<!-- ——— 迷你臺灣區 ——— -->

<section class="world-sec" id="tw">
<h2>迷你臺灣區</h2>

<p class="lead">從國父紀念館、中正紀念堂到阿里山小火車與臺灣高鐵，走一趟迷你臺灣，看見島嶼的歷史與現代共鳴。用一個上午，環島看完山海、鐵道與城市。從阿里山小火車到鵝鑾鼻燈塔，孩子能把地理位置、交通建設一次連起來。</p>

<div aria-label="迷你臺灣區圖組" class="gallery">
<figure class="frame"><img alt="迷你臺灣：中正紀念堂與城市軸線" decoding="async" loading="lazy" src="https://www.wow.com.tw/upload/images/about/2G8A7488-2s.webp" data-fallback="https://www.wow.com.tw/upload/images/about/2G8A7488-2s.jpg" onerror="this.onerror=null;this.src=this.dataset.fallback;" />
<figcaption>美麗的福爾摩沙風華絕代的藝術建築盡收眼裡，有國父紀念館、總統府、中正紀念堂、阿里山小火車及跨世紀的臺灣高鐵。</figcaption>
</figure>

<figure class="frame"><img alt="迷你臺灣：阿里山小火車穿梭山林" decoding="async" loading="lazy" src="https://www.wow.com.tw/upload/images/about/2G8A7576-2.webp" data-fallback="https://www.wow.com.tw/upload/images/about/2G8A7576-2.jpg" onerror="this.onerror=null;this.src=this.dataset.fallback;" />
<figcaption>淡水紅毛城、日治時期臺大醫院等歷史建築帶你走入時光，見證臺灣之美。</figcaption>
</figure>
</div>

<div class="content">
<article class="desc">
<h3><span class="chip">百科導讀</span></h3>

<p>🏙️ 小小臺灣有好多著名建築：國父紀念館、總統府、紅毛城&hellip;&hellip;還能看到高鐵和火車，了解從古早到現代的變化！</p>

<p>🏙️ 海的方向&mdash;&mdash;燈塔如何守護船隻？山林與鐵道&mdash;&mdash;觀察穿梭山林的阿里山鐵路！</p>
</article>

<aside aria-label="動態景觀資訊" class="meta">
<h3>動態景觀展示時間</h3>

<dl>
	<dt>平日 09:00&ndash;16:00</dt>
	<dt>假日 09:30&ndash;16:30</dt>
	<dt>備註</dt>
	<dd>遇打雷／下雨／風速達 7 級以上將調整開放。</dd>
</dl>
</aside>

<section aria-labelledby="mini-tw-title" class="wow-mini-sights">
<h5 id="mini-tw-title">迷你世界導覽<img src="https://www.wow.com.tw/upload/download/eedu/WOWapp/TOUR.webp" data-fallback="https://www.wow.com.tw/upload/download/eedu/WOWapp/TOUR.png" onerror="this.onerror=null;this.src=this.dataset.fallback;" width:25px="" /></h5>

<p class="note">以下為園區經典模型重點，實際以現場動線與展件為準。</p>

<ul role="list">
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/01阿里山火車.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/01阿里山火車.jpg" data-intro="阿里山森林鐵路源自日治時期運材而建，後轉載客觀光。起點竹崎車站保留日式木構；登山段採「後推」模式，並以螺旋、8字、Z字折返等工程巧思克服陡坡。沿線石猴奇岩與神木景觀，凝聚山林人文與鐵道技術。" data-name="阿里山小火車"><b style="color:#cc0000;">阿里山小火車</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/02阿里山神木.mp3" data-fit="contain" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/02阿里山神木.jpg" data-intro="阿里山森林鐵路源自日治時期運材而建，後轉載客觀光。起點竹崎車站保留日式木構；登山段採「後推」模式，並以螺旋、8字、Z字折返等工程巧思克服陡坡。沿線石猴奇岩與神木景觀，凝聚山林人文與鐵道技術。" data-name="阿里山神木"><b style="color:#cc0000;">阿里山神木</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/03鵝鑾鼻燈塔.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/03鵝鑾鼻燈塔.jpg" data-intro="位於台灣最南端的鵝鑾鼻燈塔，建於清代，曾具武裝防禦功能，被譽為「東亞之光」。白色塔身高21.4公尺，設於丘陵上光照遠洋；夜間每10秒閃光一次，亮度達180萬燭光。其設計融合導航、安全與地理象徵，是台灣重要的海上地標。" data-name="鵝鑾鼻燈塔"><b style="color:#cc0000;">鵝鑾鼻燈塔</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/04高速鐵路.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/04高速鐵路.jpg" data-intro="身為島嶼移動力的代表，台灣高鐵以常態時速300公里串起南港—左營，完成350公里的西部走廊與12座車站；全線約73%為高架、18%為隧道，工程尺度令人讚嘆。其中「彰化—高雄高架橋」長約157.3公里，名列全球第二長橋。走進小人國，記得找找那列穿隧、躍上高架的迷你高鐵。" data-name="高速鐵路"><b style="color:#000080;">高速鐵路</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/05十大建設-壓縮.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/05十大建設-壓縮.jpg" data-intro="1970年代因能源危機，總統蔣經國提出九大建設，後增核能成為十大：中山高、鐵路電氣化、北迴鐵路、台中港、蘇澳港、中正機場、煉鋼、石化、造船、核能。小人國以動態模型呈現領航船、救火船、下水典禮等港埠景象。" data-name="十大建設"><b style="color:#000080;">十大建設</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/06中國造船廠.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/06中國造船廠.jpg" data-intro="前身為中國造船廠，曾為全球前三大造船基地，打造出44.5萬噸超級油輪與多型軍艦。代表作「1103鄭和艦」為飛彈巡防艦，具防空與直升機甲板設計。廠區設有巨型門式起重機，模擬真實造船流程，展現台灣造船工藝與工程實力。" data-name="中國造船廠"><b style="color:#000080;">中國造船廠</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/07高速公路.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/07高速公路.jpg" data-intro="中山高速公路，堪稱台灣現代化的象徵之一。1978年全線通車，這條橫貫南北的大動脈，讓從基隆到高雄的車程，從昔日的9小時縮短至僅約4.5小時，徹底改寫了島嶼的距離感。它不僅推動經濟起飛，更串起無數家庭的記憶與旅途。少為人知的是，高速公路還兼具國防用途，全線設有5處戰備跑道，關鍵時刻能成為戰機起降的臨時基地——這段珍貴畫面，甚至登上《國家地理雜誌》。走進小人國迷你世界，縮小版的中山高以「大道之行」為起點，凝縮著台灣奔馳半世紀的榮光與速度。" data-name="高速公路"><b style="color:#000080;">高速公路</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/08石門水庫.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/08石門水庫.jpg" data-intro="位於大漢溪中游、石門山與溪洲山間，為台灣首座自行興建的多功能水庫。歷時8年完工於1964年，具灌溉、供水、發電、防洪與觀光功能。壩高133公尺、設6座弧形閘門，每秒可洩洪1.14萬立方公尺，象徵台灣水利工程的重要里程碑。" data-name="石門水庫"><b style="color:#000080;">石門水庫</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/09桃園國際機場.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/09桃園國際機場.jpg" data-intro="台灣桃園國際機場，堪稱連結世界的島嶼門戶。1979年啟用時名為「中正國際機場」，2006年正式更名為「台灣桃園國際機場」，如今每日約有近9萬5千名旅客在此進出，榮登全台最熱門打卡地。它以亞洲核心航點之姿，2小時55分鐘內即可直達香港、上海、首爾、新加坡與東京等主要城市，是亞洲航線最便捷的國際機場之一。眼前這座小人國迷你版本取材自第一航廈原型，外觀上大下小、屋簷微翹，若自空中俯瞰呈「H」字形。2013年整建後，新穎如展翼的屋頂設計更榮獲2014年《台灣建築獎》首獎，象徵台灣飛向世界的自信與力量。" data-name="桃園國際機場"><b style="color:#000080;">桃園國際機場</b></li>
	<li data-audio="https://www.wow.com.tw/upload/download/eedu/WOWapp/10神岡林宅.mp3" data-img="https://www.wow.com.tw/upload/download/eedu/WOWapp/10神岡林宅.jpg" data-intro="位於台中神岡的林宅，是典型閩南三合院建築，入口內凹、屋脊呈圓弧狀「金形馬背」，象徵招財納福。馬背造型多樣，依五行分為金圓、木直、水曲、火銳、土方，展現屋主性格與建築美學，也是體驗傳統風水文化的好例子。" data-name="神岡林宅"><b style="color:#000080;">神岡林宅</b></li>
  <!-- （中間原內容保持不動；其餘區塊的 <img> 也已同規則改成 .webp + fallback） -->
</ul>
</section>
</div>
</section>

<!-- （此處以下為原檔其餘內容，皆已保留，只是把其它 <img src="*.jpg/png"> 同步改成 src="*.webp" + data-fallback + onerror） -->

</div>
</main>
<!-- ===== 單一份彈窗腳本（含保險絲與可近用） ===== --><script>
(function(){
  // 防重初始化
  if (window.__WOW_MINI_MODAL_INIT__) return;
  window.__WOW_MINI_MODAL_INIT__ = true;

  const scope = document.querySelector('#wow-world');
  if(!scope) return;

  // 先清理殘留的舊 DOM
  document.querySelectorAll('.mini-modal, .mini-modal-backdrop').forEach(el=>el.remove());

  // 建立 DOM
  const backdrop = document.createElement('div');
  backdrop.className = 'mini-modal-backdrop';
  backdrop.setAttribute('aria-hidden','true');

  const modal = document.createElement('div');
  modal.className = 'mini-modal';
  modal.setAttribute('role','dialog');
  modal.setAttribute('aria-modal','true');
  modal.setAttribute('aria-labelledby','mini-modal-title');

  modal.innerHTML = `
    <div class="mini-card" role="document" aria-describedby="mini-modal-desc">
      <header>
        <span class="mini-sticker" aria-hidden="true">迷你世界導覽</span>
        <h3 id="mini-modal-title" class="mini-title">標題</h3>
        <button type="button" class="mini-close" aria-label="關閉視窗（Esc）">✕</button>
      </header>
      <div class="mini-body">
        <div class="mini-photo">
          <div class="mini-photo-box"><img alt="" src=""></div>
        </div>
        <div class="mini-info">
          <h4>Do You Know?</h4>
          <p class="mini-intro"></p>
          <div class="mini-actions">
            <button type="button" class="mini-audio-btn" hidden>▶ 播放語音</button>
            <span class="mini-audio-time sr-only" aria-live="polite"></span>
          </div>
          <div class="mini-progress" aria-label="播放進度控制" hidden>
            <button type="button" class="mini-skip mini-back" aria-label="倒退10秒">⏪ 10s</button>
            <input type="range" class="mini-seek" min="0" max="0" value="0" step="0.1" aria-label="播放進度">
            <button type="button" class="mini-skip mini-forward" aria-label="快轉10秒">10s ⏩</button>
            <span class="mini-time">00:00 / 00:00</span>
          </div>
          <audio class="mini-audio" preload="none"></audio>
        </div>
      </div>
      <div class="sr-only" id="mini-modal-desc">按 Esc 可關閉，Tab/Shift+Tab 於視窗內導覽。</div>
    </div>
  `;
  document.body.appendChild(backdrop);
  document.body.appendChild(modal);

  // 節點
  const closeBtn = modal.querySelector('.mini-close');
  const photoBox = modal.querySelector('.mini-photo-box');
  const imgEl    = photoBox.querySelector('img');
  const titleEl  = modal.querySelector('.mini-title');
  const introEl  = modal.querySelector('.mini-intro');
  const audioEl  = modal.querySelector('.mini-audio');
  const audioBtn = modal.querySelector('.mini-audio-btn');
  const progBox  = modal.querySelector('.mini-progress');
  const seekEl   = modal.querySelector('.mini-seek');
  const backBtn  = modal.querySelector('.mini-back');
  const fwdBtn   = modal.querySelector('.mini-forward');
  const timeLbl  = modal.querySelector('.mini-time');

  let lastFocus = null, trapHandler = null, userScrubbing = false;

  function setPreferWebp(imgUrl){
    imgEl.onerror = null;
    if(!imgUrl){
      imgEl.removeAttribute('src');
      return;
    }
    // jpg/jpeg/png -> webp（若 webp 不存在或瀏覽器不支援，onerror 退回原圖）
    const webpUrl = imgUrl.replace(/\.(jpe?g|png)(\?.*)?$/i, '.webp$2');
    if(webpUrl === imgUrl){
      imgEl.src = imgUrl;
      return;
    }
    imgEl.onerror = function(){
      this.onerror = null;
      this.src = imgUrl;
    };
    imgEl.src = webpUrl;
  }

  const fmt = t => {
    if(!isFinite(t)) t = 0;
    const m = Math.floor(t/60), s = Math.floor(t%60);
    return String(m).padStart(2,'0') + ':' + String(s).padStart(2,'0');
  };

  function updateTimeUI(){
    if (!audioEl.src) return;
    const cur = userScrubbing ? Number(seekEl.value) : (audioEl.currentTime || 0);
    const dur = audioEl.duration || 0;
    timeLbl.textContent = `${fmt(cur)} / ${fmt(dur)}`;
    if(!userScrubbing){
      seekEl.max = isFinite(dur) ? dur : 0;
      seekEl.value = isFinite(cur) ? cur : 0;
    }
  }

  function openModal({name, img, intro, audio, fit}){
    lastFocus = document.activeElement;

    titleEl.textContent = name || '展件';
    setPreferWebp(img || '');
    imgEl.alt = name ? (name + ' 圖片') : '';
    introEl.textContent = intro || '—';

    // 固定尺寸呈現；contain 模式不裁切（依 li 的 data-fit）
    photoBox.classList.toggle('is-contain', fit === 'contain');

    // 音訊（可選）
    if(audio){
      audioEl.src = audio;
      audioBtn.hidden = false;
      progBox.hidden  = false;
    }else{
      audioEl.removeAttribute('src');
      audioBtn.hidden = true;
      progBox.hidden  = true;
    }

    // 重置進度
    if (!audioBtn.hidden){ seekEl.value = 0; seekEl.max = 0; updateTimeUI(); }

    // 顯示
    modal.classList.add('is-open');
    backdrop.classList.add('is-open');
    document.documentElement.classList.add('is-modal-open');
    document.body.classList.add('is-modal-open');
    closeBtn.focus();

    // 焦點陷阱 + ESC
    trapHandler = (e)=>{
      if(e.key === 'Tab'){
        const f = Array.from(modal.querySelectorAll('button,[href],input,select,textarea,[tabindex]:not([tabindex="-1"])'))
                       .filter(el => el.offsetParent !== null);
        if(!f.length) return;
        const first = f[0], last = f[f.length-1];
        if(e.shiftKey && document.activeElement === first){ last.focus(); e.preventDefault(); }
        else if(!e.shiftKey && document.activeElement === last){ first.focus(); e.preventDefault(); }
      }else if(e.key === 'Escape'){ closeModal(); }
    };
    document.addEventListener('keydown', trapHandler);
  }

  function closeModal(){
    if(!audioEl.paused) audioEl.pause();
    modal.classList.remove('is-open');
    backdrop.classList.remove('is-open');
    document.documentElement.classList.remove('is-modal-open');
    document.body.classList.remove('is-modal-open');
    if(trapHandler) document.removeEventListener('keydown', trapHandler);
    if(lastFocus && lastFocus.focus) lastFocus.focus();
  }

  // 事件：點擊遮罩關閉
  backdrop.addEventListener('click', closeModal);
  closeBtn.addEventListener('click', closeModal);

  // 把可點的 li 變成 button（原本功能保留）
  const items = scope.querySelectorAll('.wow-mini-sights li[data-name]');
  items.forEach(li=>{
    const name = li.getAttribute('data-name') || '展件';
    const intro = li.getAttribute('data-intro') || '';
    const img = li.getAttribute('data-img') || '';
    const audio = li.getAttribute('data-audio') || '';
    const fit = li.getAttribute('data-fit') || '';

    // 加上備援 class（for 不支援 :has）
    li.classList.add('has-btn');

    // 建立按鈕
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'mini-open';
    btn.innerHTML = li.innerHTML;
    li.innerHTML = '';
    li.appendChild(btn);

    btn.addEventListener('click', ()=>openModal({name, img, intro, audio, fit}));
  });

  // 音訊控制（原本邏輯保留）
  audioBtn.addEventListener('click', ()=>{
    if(!audioEl.src) return;
    if(audioEl.paused) audioEl.play(); else audioEl.pause();
  });

  audioEl.addEventListener('loadedmetadata', updateTimeUI);
  audioEl.addEventListener('timeupdate', updateTimeUI);
  audioEl.addEventListener('ended', updateTimeUI);

  seekEl.addEventListener('input', ()=>{
    userScrubbing = true;
    updateTimeUI();
  });
  seekEl.addEventListener('change', ()=>{
    userScrubbing = false;
    audioEl.currentTime = Number(seekEl.value) || 0;
    updateTimeUI();
  });

  backBtn.addEventListener('click', ()=>{
    audioEl.currentTime = Math.max(0, (audioEl.currentTime||0) - 10);
    updateTimeUI();
  });
  fwdBtn.addEventListener('click', ()=>{
    audioEl.currentTime = Math.min(audioEl.duration||0, (audioEl.currentTime||0) + 10);
    updateTimeUI();
  });
})();
</script>
